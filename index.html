<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Dark Drive UI</title>
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background-color: #121212;
      padding: 20px;
      color: #f1f1f1;
    }

    .top-bar {
      display: flex;
      justify-content: center;
      margin-bottom: 20px;
      flex-wrap: wrap;
      gap: 10px;
    }

    .search-input {
      padding: 8px 12px;
      font-size: 14px;
      border: 1px solid #444;
      background-color: #1e1e1e;
      color: white;
      border-radius: 8px;
      width: 100%;
      max-width: 250px;
    }

    .folder-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
      gap: 20px;
    }

    .folder-tile {
      background-color: #1e1e1e;
      border-radius: 12px;
      padding: 16px 12px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.3);
      display: flex;
      flex-direction: column;
      align-items: center;
      position: relative;
      cursor: pointer;
    }

    .folder-icon-img {
      width: 48px;
      height: 48px;
      object-fit: contain;
      margin-bottom: 12px;
      filter: brightness(0.95);
    }

    .folder-label {
      font-size: 14px;
      text-align: center;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
    }

    .options-icon {
      font-size: 16px;
      cursor: pointer;
      color: #bbb;
    }

    .back-button {
      display: none;
      margin: 16px 0;
      background: #4285f4;
      color: white;
      padding: 8px 16px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
    }

    .file-list {
      display: flex;
      flex-direction: column;
      gap: 16px;
    }

    .file-item {
      background-color: #1e1e1e;
      padding: 12px;
      display: flex;
      align-items: center;
      gap: 16px;
      border-radius: 8px;
      font-weight: bold;
      border-bottom: 1px solid #333;
      position: relative;
    }

    .file-icon {
      width: 40px;
      height: 50px;
      background-color: #a87c4f;
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
      font-family: monospace;
      border-radius: 4px;
      flex-shrink: 0;
    }

    .file-name {
      font-size: 16px;
      flex-grow: 1;
    }

    .file-options {
      font-size: 20px;
      cursor: pointer;
      color: #bbb;
    }

    .popup-menu {
      position: absolute;
      top: 100%;
      right: 8px;
      background-color: #2a2a2a;
      border: 1px solid #444;
      border-radius: 8px;
      padding: 6px 0;
      z-index: 100;
      width: 140px;
      box-shadow: 0 0 10px rgba(0,0,0,0.5);
    }

    .popup-menu div {
      padding: 8px 12px;
      cursor: pointer;
      font-size: 14px;
    }

    .popup-menu div:hover {
      background-color: #3a3a3a;
    }
  </style>
</head>
<body>

<div class="top-bar">
  <input type="text" class="search-input" id="searchInput" placeholder="Search folders..." />
  <input type="text" class="search-input" id="fileSearchInput" placeholder="Search files..." style="display: none;" />
</div>

<button class="back-button" id="backButton">← Back to folders</button>

<div class="folder-grid" id="folderGrid"></div>
<div class="file-list" id="fileList" style="display: none;"></div>

<script>
  const folderGrid = document.getElementById('folderGrid');
  const fileList = document.getElementById('fileList');
  const backButton = document.getElementById('backButton');
  const searchInput = document.getElementById('searchInput');
  const fileSearchInput = document.getElementById('fileSearchInput');

  let folders = [];
  let currentFolder = null;

  async function fetchData() {
    const res = await fetch("https://raw.githubusercontent.com/blackshadowh4ck3r/Files-Store/refs/heads/main/Data.json");
    const data = await res.json();
    folders = data.filter(f => f.show);
    renderFolders();
  }

  function renderFolders(filter = "") {
    folderGrid.innerHTML = '';
    fileList.style.display = 'none';
    folderGrid.style.display = 'grid';
    backButton.style.display = 'none';
    fileSearchInput.style.display = 'none';

    folders
      .filter(folder => folder.folderName.toLowerCase().includes(filter.toLowerCase()))
      .forEach(folder => {
        const tile = document.createElement('div');
        tile.className = 'folder-tile';
        tile.onclick = () => openFolder(folder);

        const imageUrl = folder.imageUrl || 'https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgRfZHukGJnIhyphenhyphen3Yo_5gLpxtIqsHQbY9eyJ3uHI-qQEcX7OvA3SMixdOt1-zjpFiXmvwzsjxkVnWz1uWAReZ7qdfQiSIxCUd3sOL1fkpNWlkM1x-cGnPCyfqejxdh0YgpmwXVsThWpLacLMeM1RRw8A66QB04ralG5aPDEO4DM2NfJ2eh_ZZWrmsw1jze8s/s320/1caac431-872a-4c00-b330-688ef6617399_removalai_preview.png'; // default folder icon image

        tile.innerHTML = `
          <img src="${imageUrl}" class="folder-icon-img" />
          <div class="folder-label">
            ${folder.folderName}
            <span class="options-icon">⋮</span>
          </div>
        `;
        folderGrid.appendChild(tile);
      });
  }

  function openFolder(folder) {
    currentFolder = folder;
    fileSearchInput.value = '';
    renderFiles('');
    fileList.style.display = 'flex';
    folderGrid.style.display = 'none';
    backButton.style.display = 'inline-block';
    fileSearchInput.style.display = 'inline-block';
  }

  function renderFiles(filter = '') {
    fileList.innerHTML = '';

    const filteredFiles = currentFolder.files.filter(file =>
      file.show && (
        file.fileName.toLowerCase().includes(filter.toLowerCase()) ||
        file.fileExtension.toLowerCase().includes(filter.toLowerCase())
      )
    );

    filteredFiles.forEach(file => {
      const item = document.createElement('div');
      item.className = 'file-item';

      item.innerHTML = `
        <div class="file-icon">${file.fileExtension.replace('.', '').toUpperCase()}</div>
        <div class="file-name">${file.fileName} <span style="font-weight: normal; color: #ccc;">(${file.fileSize})</span></div>
        <div class="file-options">⋮</div>
      `;

      const optionsIcon = item.querySelector('.file-options');
      optionsIcon.addEventListener('click', (e) => {
        e.stopPropagation();
        closeAllPopups();
        const popup = document.createElement('div');
        popup.className = 'popup-menu';
        popup.innerHTML = `
          <div onclick="copyLink('${file.copyLink}')">Copy Link</div>
          <div onclick="window.open('${file.downloadLink}', '_blank')">Download</div>
        `;
        item.appendChild(popup);
      });

      fileList.appendChild(item);
    });
  }

  function closeAllPopups() {
    document.querySelectorAll('.popup-menu').forEach(el => el.remove());
  }

  function copyLink(link) {
    navigator.clipboard.writeText(link).then(() => {
      alert(`Copied link: ${link}`);
    });
    closeAllPopups();
  }

  backButton.onclick = () => {
    currentFolder = null;
    renderFolders();
  };

  searchInput.addEventListener('input', () => renderFolders(searchInput.value));
  fileSearchInput.addEventListener('input', () => renderFiles(fileSearchInput.value));
  document.addEventListener('click', closeAllPopups);

  fetchData();
</script>

</body>
</html>
